@inherits LayoutComponentBase
@inject NavigationManager Nav

<div class="d-flex" style="height: 100vh; overflow: hidden;">

    <!-- 1. SIDEBAR -->
    <div class="d-flex flex-column bg-dark text-white border-end transition-sidebar" 
         style="width: @(_collapsed ? "80px" : "260px"); 
                min-width: @(_collapsed ? "80px" : "260px"); 
                height: 100vh; 
                background-color: #1e293b !important; 
                transition: all 0.3s ease;">
        
        <!-- HEADER SIDEBAR -->
        <div class="d-flex align-items-center px-3 border-bottom border-secondary border-opacity-25" 
             style="height: 70px;">
            
            <!-- Lógica do Cabeçalho da Sidebar -->
            @if (_collapsed)
            {
                <!-- MODO FECHADO: Apenas o botão Hambúrguer centralizado -->
                <button class="btn btn-link text-light p-0 w-100 text-center" 
                        @onclick="ToggleSidebar" title="Expandir Menu">
                    <i class="bi bi-list fs-3"></i>
                </button>
            }
            else
            {
                <!-- MODO ABERTO: Logo + Botão na direita -->
                <div class="d-flex align-items-center justify-content-between w-100">
                    <div class="d-flex align-items-center gap-2">
                        <div class="bg-primary rounded p-1 d-flex align-items-center justify-content-center" style="width: 32px; height: 32px;">
                             <i class="bi bi-grid-1x2-fill text-white"></i>
                        </div>
                        <span class="fw-bold fs-5 text-nowrap tracking-wide">SindRelat.</span>
                    </div>
                    
                    <button class="btn btn-link text-secondary p-0" @onclick="ToggleSidebar">
                        <i class="bi bi-list fs-4"></i>
                    </button>
                </div>
            }
        </div>

        <!-- MENU -->
        <div class="flex-grow-1 overflow-y-auto overflow-x-hidden py-4">
            <NavMenu Collapsed="_collapsed" />
        </div>

        <!-- FOOTER -->
        <div class="p-3 border-top border-secondary border-opacity-25 text-center text-muted small">
            @if (!_collapsed) { <span class="opacity-50">v1.0.0</span> }
        </div>
    </div>

    <!-- 2. CONTEÚDO PRINCIPAL -->
    <div class="d-flex flex-column flex-grow-1 bg-light" style="overflow-y: auto;">
        
        <!-- HEADER SUPERIOR -->
        <nav class="navbar navbar-light bg-white shadow-sm px-4 sticky-top border-bottom justify-content-between" 
             style="height: 70px; min-height: 70px;">
            
            <!-- Título da Página -->
            <span class="navbar-text fw-bold text-secondary">
                Painel Administrativo
            </span>

            <!-- ÁREA DO USUÁRIO / ADMIN -->
            <div class="d-flex align-items-center gap-3">
                <!-- 
            
                -->
                <button class="btn btn-light border rounded-pill px-3 py-1 d-flex align-items-center gap-2 hover-shadow" 
                        @onclick='() => Nav.NavigateTo("dev-panel")'
                        title="Acessar Painel do Desenvolvedor">
                    
                    <div class="bg-primary text-white rounded-circle d-flex align-items-center justify-content-center" 
                         style="width: 30px; height: 30px;">
                        <i class="bi bi-person-fill small"></i>
                    </div>
                    
                    <span class="small fw-bold text-secondary me-1">Admin</span>
                </button>
            </div>
        </nav>

        <!-- CORPO -->
        <div class="p-4">
            @Body
        </div>
    </div>
</div>

<style>
    .tracking-wide { letter-spacing: 0.5px; }
    .hover-shadow:hover { box-shadow: 0 .5rem 1rem rgba(0,0,0,.15)!important; border-color: #dee2e6 !important; }
    
    /* Scrollbar fina */
    ::-webkit-scrollbar { width: 6px; height: 6px; }
    ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
    ::-webkit-scrollbar-track { background: transparent; }
</style>

@code {
    private bool _collapsed = false;
    private void ToggleSidebar() => _collapsed = !_collapsed;
}